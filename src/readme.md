## Part 1. Инструмент **ipcalc**

1. ![ipcalc install](png/1.png)  
Устанавливаем инструмент ipcalc(sudo apt install ipcalc)

2. ![ipcalc 192.167.38.54/13](png/1.1.png)  
- ввел команду ipcalc 192.167.38.54/13  
- адрес сети - 192.160.0.0/13

3. ![ipcalc 255.255.255.0](png/1.2.png)  
    - ввел команду ipcalc 192.167.38.54/13  
    - 255.255.255.0 = префиксная /24
    - 255.255.255.0 = в двоичной 11111111.11111110.00000000.00000000

4. ![ipcalc /15](png/1.3.png)  
    - ввел команду ipcalc /15  
    - /15 = обычная 255.254.0.0
    - /15 = двоичная 11111111.11111110.00000000.00000000
  
5. 
    - 11111111.11111111.11111111.11110000 перевод в маску 255.255.255.240
    - 11111111.11111111.11111111.11110000 = префикс /28


6. ![ipcalc 12.167.38.4/8](png/1.4.png)  
    - ввел команду ipcalc  12.167.38.4/8
    - Минимальный хост: 12.0.0.1
    - Максимальный хост: 12.255.255.254

7. ![ipcalc 12.167.38.4/16](png/1.5.png)  
    - Маска 11111111.11111111.00000000.00000000 это префикс /16  
    - ввел команду ipcalc  12.167.38.4/16
    - Минимальный хост: 12.167.0.1
    - Максимальный хост: 12.167.255.254

8. ![ipcalc 12.167.38.4/255.255.254.0](png/1.6.png)
    - ввел команду ipcalc  12.167.38.4/255.255.254.0
    - Минимальный хост: 12.167.38.1
    - Максимальный хост: 12.167.39.254

9. ![ipcalc 12.167.38.4/4](png/1.7.png)
    - ввел команду ipcalc 12.167.38.4/4
    - Минимальный хост: 0.0.0.1
    - Максимальный хост: 15.255.255.254

10. - 194.34.23.100 - этот ip не является частью диапозона
    - 127.0.0.2 - ip принадлжеит диапозону
    - 127.1.0.1 - ip принадлжеит диапозону
    - 128.0.0.1 - этот ip не является частью диапозона

11. ![частные IP адреса](png/chastnie.png)
    - частные ip адреса

12. - 10.0.0.45 - частный
    - 134.43.0.2 - публичный
    - 192.168.4.2 - частный
    - 172.20.250.4 - частный
    - 172.0.2.1 - публичный
    - 192.172.0.1 - публичный
    - 172.68.0.2 - частный
    - 172.16.255.255 - частный
    - 10.10.10.10 - частный
    - 192.169.168.1 - публичный


13. - диапозон от 10.10.0.1 до  10.10.63.254
    - 10.0.0.1 - не входит в диапозон 
    - 10.10.0.2 - входит в диапозон
    - 10.10.10.10 - входит в диапозон
    - 10.10.100.1 - входит в диапозон
    - 10.10.1.255 - не входит в диапозон

## Part 2. Статическая маршрутизация между двумя машинами

1. ![ip a -> ws1](png/2.1.png)
   ![ip a -> ws2](png/2.2.png)
    - ip a для ws1 и ws2

2. ![ws1](png/2.3.png)
    - Измененный конфиг для ws1

3. ![ws2](png/2.4.png)
    - Измененный конфиг для ws2

4. ![sudo netplan apply ws1](png/2.5.png)
   ![sudo netplan apply ws2](png/2.6.png)
    - sudo netplan apply

5. ![ws1 -> sudo ip route add 172.24.116.8 dev enp1s0](png/2.7.png)
   ![](png/2.9.png)
    - ввёл команду sudo ip route add 172.24.116.8 dev enp1s0, после чего успешно пропинговал ws2

6. ![ws2 -> sudo ip route add 192.168.100.10 dev enp1s0 ](png/2.8.png)
   ![](png/2.10.png)
    - ввёл команду sudo ip r add 192.168.100.10 dev enp1s0, после чего успешно пропинговал ws1

7. ![конфигурации netplan для ws1 и ws2](png/2.11.png)
   ![](png/2.12.png)
    - изменил конфигурационный файл для ws1 и ws2, добавив статическую маршрутизацию с помощью routes

8. ![пинги от машины к машине](png/2.13.png)
   ![](png/2.14.png)
    - пинг от ws1 -> ws2 и пинг от ws2 -> ws1

## Part 3. Утилита **iperf3**

1. Перевод:
    - 8 Mbps (мегабит в сек) = 1 MB/s (мегабайт в сек)
    - 100 MB/s (мегабайт в сек) = 819200 Kbsp (килобит в сек)
    - 1 Gbps (гигабит в сек) = 1024 Mbps (мегабит в сек)

2.  - sudo apt install iperf3


3. ![ws1 сервер,а ws2 клиент](png/3.1.png)
   ![](png/3.2.png)
    - на ws1 iperf3 -s -f M(для отображения в МегаБайтах)
    - на ws2 iperf3 -c 192.168.100.10(для подключения)

## Part 4. Сетевой экран

1. ![файл для ws1](png/4.1.png)
   ![файл для ws2](png/4.2.png)
    - F - очищает все правила и цепочки 
    - X - удаляет пользовательские цепочки
    - A - добовляет правило в конец указанной цепочки
    - p - указывает протокол для правила
    - dport - указывает порт для трафика
    - j - цель для правила 
    - icmp-type - для указания типо ICMP-сообщения

2. ![вызов команды](png/4.3.png)
    - вызов команды sudo chmod +x /etc/firewall.sh
    - вызов команды sudo bash /etc/firewall.sh
    - вызов команды iptable -L для просмотра правил

3. На ws1 в начале применяется запрещающее правило (DROP), а затем разрешающее правило (ACCEPT), сначала блокируется весь трафик, а затем разрешается только определенный, весь трафик будет отвергнут, если не соответствует определенным правилам.

4. На ws2 в начале применяется разрешающее правило (ACCEPT), а затем запрещающее правило (DROP), сначала разрешается весь трафик, а затем блокируется только определенный , весь трафик будет принят, если не соответствует определенным правилам.

5. ![ws1 пингует ws2](png/4.5.png)
   ![ws2 не пингует ws1](png/4.6.png)
    - проверяем пинг на ws1 к ws2 (пингует)
    - проверяем пинг на ws2 к ws1 (не пингует)

6. ![nmap с ws2 на ws1](png/4.7.png)
    - утилитой nmap проверяем Host is up

## Part 5. Статическая маршрутизация сети

sudo systemctl restart systemd-networkd - для перезапуска сервиса сети

1. ![ws11](png/5.1ws11.png)
    - конфиг для ws11
    
2. ![ws21](png/5.4ws21.png)
    - конфиг для ws21

3. ![ws22](png/5.5ws22.png)
    - конфиг для ws22

4. ![r1](png/5.2r1.png)
    - конфиг для r1

5. ![r2](png/5.3r2.png)
    - конфиг для r2

6. ![ip -4 a](png/5.1.1.png)
   ![](png/5.1.2.png)
   ![](png/5.1.3.png)
   ![](png/5.1.4.png)
   ![](png/5.1.5.png)
    - ip -4 a для всех машин

7. ![ping ws21 -> ws22](png/5.6pingws21.png)
    - ping ws22 с ws21

8. ![ping ws11 -> r1](png/5.8pingws11.png)
    - ping r1 c ws11

9. ![sysctl -w net.ipv4.ip_forward=1](png/5.10.png)
   ![](png/5.11.png)
    - команда на r1 и r2

10. ![для r1](png/5.12r1.png)
    - убрал # для ipv4

11. ![для r2](png/5.13r2.png)
    - убрал # для ipv4

12. ![конфиг для ws11](png/5.14.png)
    ![конфиг для ws21](png/5.15.png)
    ![конфиг для ws22](png/5.16.png)
    - измененный конфиги 

13. ![ip r для ws11](png/5.17.png)
    ![ip r для ws21](png/5.18.png)
    ![ip r для ws22](png/5.19.png)
    - ip r для всех машин

14. ![пинг с ws11 к r2](png/5.20.png)
    ![tcpdump r2](png/5.21.png)
    - tcpdump -tn -i enp1s0

15. ![конфигурации для r1](png/5.22.png)
    ![конфигурация для r2](png/5.23.png)
    - измененные конфигурации 

16. ![ip r r1](png/5.24.png)
    ![ip r r2](png/5.25.png)
    - ip r для r1 и r2

17. ![ip r list 10.10.0.0/18 и ip r list 0.0.0.0/0](png/5.26.png)
    - Маршрут 10.10.0.0/18 является более конкретным, чем 0.0.0.0/0, т.к охватывает более узкий диапозон, и поэтому маршрут по умолочанию не будет использоваться, так как есть более точный маршрут для этой сети. Это позволяет более точно маршрутизировать пакеты.

18. ![tcpdump ](png/5.27.png)
    - tcpdump -tnv -i enp1s0

19. ![traceroute](png/5.28.png)
    - traceroute 10.20.0.10

20. Утилита traceroute использует принцип работы сетевого протокола ICMP (Internet Control Message Protocol) для построения пути от отправителя до получателя. Она отправляет серию пакетов с увеличивающимся значением TTL (Time To Live) и отслеживает ответы от промежуточных маршрутизаторов на пути к целевому хосту.

21. ![tcpdump enp1s0](png/5.29.png)
    ![ping](png/5.30.png)
    - на r1 sudo tcpdump -n -i enp1s0 icmp
    - на ws11 ping -c 1 10.30.0.111
    - ICMP -  сетевой протокол, в основном ICMP используется для передачи сообщений об ошибках и других исключительных ситуациях, возникших при передаче данных.

## Part 6. Динамическая настройка IP с помощью **DHCP**

1. ![dhcpd](png/6.1.png)
    - изменил конфигурационый файл 

2. ![resolv](png/6.2.png)
    - изменил resolv.conf

3. ![restart dhcp](png/6.3.png)
    - перезапуск службы DHCP systemctl restart isc-dhcp-server

4. ![ip a](png/6.4.png)
    - на ws21: ip a и пинг ws21 -> ws22

5. ![netplan ws11](png/6.5.png)
    - изменил конфиг для ws11

6. ![dhcpd](png/6.6.png)
    - конфиг для r1
    
7. ![resolv](png/6.7.png)
    - изменил файл resolv для r1

8. ![ip a](png/6.8.png)
   ![ping](png/6.9.png)
    - на ws21: ip a и пинг ws21 -> ws22

9. ![dhclient -v](png/6.11.png)
    - освобождаем IP-адрес DHCP-клиента с помощью команды sudo dhclient -r и получаем новый IP-адрес с помощью DHCP с помощью команды sudo dhclient -v

10. ![ip a](png/6.12.png)
    - ip a после обновления

11. 
    - Настройка конфигурации службы DHCP (адрес маршрутизатора по-умолчанию, DNS-сервер, адрес внутренней сети, привязка к MAC-адресу)
    - Клиент протокола динамической конфигурации хоста (команда dhclient) для обновления или освобождения IP-адреса

## Part 7. **NAT**

1. ![ws22](png/7.1.png)
   ![r1](png/7.2.png)
    - изменил конфиги на ws22 и r1

2. ![apache2 start r1](png/7.3.png)
   ![apache2 start ws22](png/7.4.png)
    - запустил веб-сервер apache2

3. ![firewall](png/7.5.png)
    - добовляем в firewall правила по заданию

4. ![firewall chmod sh](png/7.6.png)
    - запускаем firewall 

5. ![ping](png/7.7.png)
    - с r1 не пингуется ws22

6. ![firewall](png/7.10.png)
    - Добавили в firewall правило для обработки входящих icmp пакетов

7. ![ping](png/7.9.png)
    - с r1 пингуется ws22 

8. ![firewall](png/7.11.png)
    - добавляем в firewall следущие правила

9. ![telnet ws22](png/7.13.png)
    - на ws22 telnet 10.100.0.12 8080

10. ![telnet r1](png/7.12.png)
    - на r1 telnet 10.100.0.11 80

## Part 8. Дополнительно. Знакомство с **SSH Tunnels**

1. ![apache2](png/8.1.png)
    - на ws22 изменили конфигурацию apache2

2. ![ssh -L](png/8.2.png)
    - с помощью команды ssh -L 8080:localhost:80 10.20.0.15 подключаемся к ws22 с ws21

3. ![telnet](png/8.4.png)
    - физически находясь на ws21, а в терминале на ws22, проверяем через telnet сработало ли подключение

4. ![ssh -R](png/8.3.png)
    - с ws11 подключаемся к ws22 ssh -R 8080:localhost:80 10.20.0.20

5. ![telnet](png/8.5.png)
    - проверяем через telnet сработало ли подключение